<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Car Details</title>
    <link rel="stylesheet" href="style.css">
    <link rel="stylesheet" href="style-checkbox.css">
    <link rel="icon" href="icons/favicon.ico" type="image/x-icon">
</head>

<body>
    <div id="header-container"></div>
    <div id="overlay" class="overlay"></div>

    <!-- Popup Containers -->
    <div id="consumptionPopup" class="popup-container" style="display: none;"></div>
    <div id="emissionsPopup" class="popup-container" style="display: none;"></div>
    <div id="documentsPopup" class="popup-container" style="display: none;"></div>



    <div class="car-listings">
        <div id="carDetailsContainer">
            <div id="carImageGallery">
                <div id="carTitle"></div>
                <div id="carImageContainer">
                    <img id="carImage" class="car-image" alt="Car Image">
                    <div class="navButtonContainer" id="navButtons">
                        <button class="navButton" id="prevImage">&lt;</button>
                        <button class="navButton" id="nextImage">&gt;</button>
                    </div>
                    <label id="photoCountLabel" class="photo-count-label">
                        <img src="icons/photo-count.svg" alt="Info Icon" width="16" height="16">
                    </label>
                </div>
                <div id="thumbnailContainer"></div>
            </div>

            <div id="carFinanceContainer">
                <div class="section" id="overview"></div>

                <!-- Pay Details Section Start -->
                <section class="pay-details-section">
                    <div class="sidebar">
                        <div class="sidebar__prices">
                            <div class="section" id="overview"></div>
                            <div class="sidebar__discount">
                                <label id="discountLabel" class="discount-label">
                                    <img src="icons/discount-icon.svg" width="18" height="18" alt="Discount Icon">
                                    <span>30% descuento</span>
                                </label>
                                <span>¡Te ahorras 9.120€!</span>
                            </div>
                            <div class="price-items">
                                <div class="box contrast">
                                    <span class="medium">Financiando</span>
                                    <span class="small">sujeto a financiación</span>
                                    <span id="precioFinacio" class="large"></span>
                                </div>
                                <div class="box">
                                    <span class="medium">Al contado</span>
                                    <span class="small">sin financiación</span>
                                    <span id="precioNuevo" class="large"></span>
                                </div>
                            </div>
                        </div>
                        <div class="sidebar__financing">
                            <span class="medium">Llévatelo financiado</span>
                            <div class="row">
                                <span id="pmtValue" class="small">desde 535€/mes*</span>
                                <a href="#vehicle-financing" class="vehicle-financing-calculator">Recalcular cuota</a>
                            </div>
                        </div>
                        <div class="sidebar__breakdown">
                            <div id="price-calculator" class="price-calculator" data-price="47990">
                                <div class="price-group">
                                    <div id="carFinanceOptionsContainer" class="price-group__entries"></div>
                                </div>
                                <div class="vehicle-price-result-container">
                                    <div id="vehicle-price-result" class="vehicle-price-result">
                                        <span class="entry__title">Precio Final</span>
                                        <span id="PrecioFinal" class="entry__amount"></span>
                                    </div>
                                    <div class="vehicle-price-result__text">
                                        <small>Todo incluido. Llave en mano.</small>
                                    </div>
                                    <div class="vehicle-price-result__action">
                                        <button class="button1">
                                            <!-- SVG Icon before text -->
                                            <img src="icons/filter-icon.svg" alt="Icon" width="16" height="16"
                                                class="btn-icon">
                                            <span>Avísame si baja de precio</span>
                                        </button>
                                    </div>
                                    <!-- Section to edit -->
                                    <div class="vehicle-sidebar__main-actions">
                                        <div class="list-grid list-grid--2 list-grid--gap-1">
                                            <a href="#" class="btn btn-primary-action" data-toggle="modal"
                                                data-target="[data-modal-vehicle-contact]">
                                                <div class="d-flex justify-content-between align-items-center">
                                                    <img src="icons/filter-icon.svg" alt="Icon" width="16" height="16"
                                                        class="btn-icon">

                                                    <span class="text-left">
                                                        Contactar<br>
                                                        Ahora
                                                    </span>

                                                    <span class="fa-sharp fa-regular fa-arrow-right"></span>
                                                </div>
                                            </a>

                                            <a href="#" class="btn btn-outline-primary-action" data-toggle="modal"
                                                data-target="[data-modal-vehicle-test-drive]">
                                                <div class="d-flex justify-content-between align-items-center">
                                                    <img src="icons/filter-icon.svg" alt="Icon" width="16" height="16"
                                                        class="btn-icon">

                                                    <span class="text-left">
                                                        Pruébalo sin<br>
                                                        compromiso
                                                    </span>

                                                    <span class="fa-sharp fa-regular fa-arrow-right"></span>
                                                </div>
                                            </a>
                                        </div>
                                    </div>

                                    <div class="trust-message">
                                        <div class="trust-message__icon fa-solid fa-message-smile fa-flip-horizontal">
                                        </div>

                                        <div class="trust-message__title">
                                            Incluído <u>GRATIS</u>
                                        </div>

                                        <div class="trust-message__text">
                                            <ul class="list-vertical list-vertical--check pl-1 mb-0"
                                                style="--decorator-color: var(--color-primary-action)">
                                                <li>12 meses de garantía</li>
                                                <li>Costes de gestión y transferencia</li>
                                            </ul>
                                        </div>
                                    </div>

                                    <p class="mt-3 mb-0 color--neutral-300">
                                        <small>
                                            * Precio válido salvo error tipográfico.
                                        </small>
                                    </p>

                                </div>

                                <div class="vehicle-sidebar__after mt-3">
                                    <div class="row">
                                        <div class="col-6 text-center">
                                            <a href="https://www.sibuscascoche.com/coches-ocasion/audi/a4/avant-advanced-35-tdi-110kw-s-tronic/print"
                                                title="Imprimir ficha" class="link-action" data-track-vehicle-event=""
                                                data-track-vehicle-event-category="ficha"
                                                data-track-vehicle-event-action="imprimir-ficha"
                                                data-track-vehicle-event-label="https://www.sibuscascoche.com/coches-ocasion/audi/a4/avant-advanced-35-tdi-110kw-s-tronic"
                                                rel="nofollow" target="_blank">
                                                <i class="fal fa-print"></i> Imprimir ficha
                                            </a>
                                        </div>

                                        <div class="col-6 text-center">
                                            <a href="#" title="Enviar por email" class="link-action" data-toggle="modal"
                                                data-target="[data-modal-vehicle-send-to-friend]">
                                                <i class="fal fa-envelope"></i> Enviar por email
                                            </a>
                                        </div>
                                    </div>
                                </div>
                                <!-- Section to edit end-->
                            </div>
                        </div>
                    </div>
                </section>
                <!-- Pay Details Section End -->
            </div>
            <div id="carInfoContainer">
                <div id="carOverviewContainer" class="details-container"></div>
                <!-- Section to edit -->
                <div class="text-center mt-4">
                    <p class="background-color--neutral-100 px-3 py-2 border-radius-3 d-inline-block">
                        <span class="fal fa-hashtag"></span> Referencia:
                        SIBUSCASCOCHE/VO/32165
                    </p>
                </div>
                <div class="text-center">
                    <a data-scroll="" href="#equipamiento" class="btn btn-outline-primary-action">
                        Ver equipamiento completo
                    </a>
                </div>
                <!-- Section to edit end-->

                <div class="section" id="carroceria"></div>
                <div class="section" id="motorYTransmision"></div>
                <div class="section" id="consumoYEmisiones"></div>
                <div class="section" id="garantiaContainer"></div>
                <div class="section" id="equipamiento"></div>
            </div>

            <!-- Section to edit -->
            <div id="vehicle-financing" class="vehicle-financing">
                <div class="text-center mb-5">
                    <h2>Financiación 100% sin entrada</h2>
                    <p>Grandes descuentos por financiar con nosotros. ¡Descúbrelos!</p>
                </div>

                <!-- Controls Section -->
                <div class="financing-calculator__controls">
                    <!-- Initial Deposit -->
                    <div class="financing-calculator__deposit">
                        <span class="label">Entrada inicial</span>
                        <input id="deposit-input" class="form-control" type="text" inputmode="decimal" value="&nbsp;">
                        <span class="ml-2 font-italic text-muted" id="max-deposit-text">Máxima: 5.400€</span>
                        <input id="deposit-slider" class="slider" type="range" min="0" max="5400" step="200">
                    </div>

                    <!-- Initial Term -->
                    <div class="financing-calculator__term">
                        <span class="label">Duración</span>
                        <select class="form-control" id="term-select">
                            <option value="2">2 años</option>
                            <option value="3">3 años</option>
                            <option value="4">4 años</option>
                            <option value="5">5 años</option>
                            <option value="6">6 años</option>
                            <option value="7">7 años</option>
                            <option value="8">8 años</option>
                            <option value="9">9 años</option>
                            <option value="10">10 años</option>
                        </select>
                        <input type="range" min="2" max="10" step="1" class="slider" id="term-slider">
                    </div>

                    <!-- Quota Button -->
                    <div class="financing-calculator__quota mt-4">
                        <button id="quota-button">
                            <div>Quiero esta cuota</div>
                            <div class="amount">315€/mes</div>
                        </button>
                    </div>
                </div>

                <!-- Summary Section -->
                <div id="loanPopup" class="financing-calculator__summary mt-4">
                    <!-- Popup content will be injected here by JavaScript -->
                </div>
            </div>

            <div id="companyAdvantagesContainer" class="details-container"></div>
        </div>

    </div>
    <footer id="footer" class="footer bg-dark text-light py-4" style="background-color: #343a40; color: #f8f9fa;">

        <div class="container">
            <div class="row">
                <!-- Company Info -->
                <div class="col-md-3">
                    <h5 class="footer-title">Company</h5>
                    <ul class="list-unstyled">
                        <li><a href="/about" class="text-light">About Us</a></li>
                        <li><a href="/careers" class="text-light">Careers</a></li>
                        <li><a href="/blog" class="text-light">Blog</a></li>
                        <li><a href="/contact" class="text-light">Contact Us</a></li>
                    </ul>
                </div>

                <!-- Customer Service -->
                <div class="col-md-3">
                    <h5 class="footer-title">Customer Service</h5>
                    <ul class="list-unstyled">
                        <li><a href="/faq" class="text-light">FAQ</a></li>
                        <li><a href="/returns" class="text-light">Returns</a></li>
                        <li><a href="/shipping" class="text-light">Shipping Information</a></li>
                        <li><a href="/terms" class="text-light">Terms & Conditions</a></li>
                    </ul>
                </div>

                <!-- Social Media -->
                <div class="col-md-3">
                    <h5 class="footer-title">Follow Us</h5>
                    <div class="social-media">
                        <a href="https://facebook.com" class="text-light me-2" aria-label="Facebook">
                            <i class="fab fa-facebook-f"></i>
                        </a>
                        <a href="https://twitter.com" class="text-light me-2" aria-label="Twitter">
                            <i class="fab fa-twitter"></i>
                        </a>
                        <a href="https://instagram.com" class="text-light me-2" aria-label="Instagram">
                            <i class="fab fa-instagram"></i>
                        </a>
                        <a href="https://linkedin.com" class="text-light" aria-label="LinkedIn">
                            <i class="fab fa-linkedin-in"></i>
                        </a>
                    </div>
                </div>

                <!-- Contact Information -->
                <div class="col-md-3">
                    <h5 class="footer-title">Contact Information</h5>
                    <address>
                        <p><i class="fas fa-map-marker-alt"></i> 123 Main Street, Anytown, USA</p>
                        <p><i class="fas fa-phone"></i> +1 234 567 890</p>
                        <p><i class="fas fa-envelope"></i> <a href="mailto:info@example.com"
                                class="text-light">info@example.com</a></p>
                    </address>
                </div>
            </div>

            <div class="text-center mt-4">
                <p class="mb-0">&copy; 2024 Your Company Name. All rights reserved.</p>
            </div>
        </div>
    </footer>
</body>

<script src="myPopups.js" defer></script>

<script type="module">
    import { initializeState, initializeElements, initializeCarData } from './initializers.js';
    import { loadHtml, fetchJson } from './fetchUtils.js';
    import { preloadImages, setupStateImages, setupImageEventListeners } from './imageFunctions.js';
    import { setLoanParameters, calculateRate, formatCurrency } from './loanCalculator.js';
    import { handleDeliveryCheckboxChange, handleFinanceCheckboxChange } from './checkboxHandlers.js';

    import { initializeFinanceCalcEventListeners } from './financeCalc.js';

    document.addEventListener('DOMContentLoaded', async () => {
        const state = initializeState();
        const elements = initializeElements();

        if (!state.carReference) {
            elements.carDetailsContainer.innerHTML = '<p>No car reference provided.</p>';
            return;
        }

        await loadHtml(elements.headerContainer, 'header.html');
        state.carData = await fetchJson(`listings/${state.carReference}/data.json`);

        const carData = initializeCarData(state);

        if (state.carData) {
            setupStateImages(state, carData.imageCount);
            preloadImages(state.imageUrls, state, elements.thumbnailContainer);
            renderCarDetails(state, elements);
            setupImageEventListeners(state, elements);
            setupCheckboxEventListeners(state, elements); // Pass state and elements here

            // Event listener for overlay click
            document.getElementById('overlay').addEventListener('click', () => hideAllPopups());

            // Calculate financing details
            const vehicleDeposit = carData.price * 0.1;
            const { annualRateTIN, loanLengthMonths, commissionRate } = setLoanParameters(carData.price, carData.year, carData.kilometres);

            const result = calculateRate(
                loanLengthMonths / 12, // Convert months to years
                carData.price, // Total price
                vehicleDeposit, // Initial deposit
                annualRateTIN / 100, // Convert annual rate from percentage
                commissionRate / 100, // Convert commission rate from percentage
                0.0 // No additional fees
            );

            // Initialize setup
            initializeFinanceCalcEventListeners(carData.price, annualRateTIN, commissionRate, elements);
        }

        function setupCheckboxEventListeners(state, elements) {
            // Set up MutationObserver to watch for dynamically added checkboxes
            const observer = new MutationObserver((mutations) => {
                mutations.forEach((mutation) => {
                    if (mutation.addedNodes.length) {
                        const financeCheckbox = document.getElementById('financeCheckbox');
                        const deliveryCheckbox = document.getElementById('deliveryCheckbox');

                        if (financeCheckbox) {
                            financeCheckbox.addEventListener('change', (event) => {
                                handleFinanceCheckboxChange(event, state, elements, state.carData.CaracteristicasGenerales.PrecioNuevo);
                            });
                        }

                        if (deliveryCheckbox) {
                            deliveryCheckbox.addEventListener('change', async (event) => {
                                await handleDeliveryCheckboxChange(event, state, elements);
                            });
                        }
                    }
                });
            });

            observer.observe(elements.carFinanceOptionsContainer, { childList: true });
        }

        function renderCarDetails(state, elements) {
            // Initialize car data
            const carData = initializeCarData(state);

            // Update the car title and image
            elements.carTitle.textContent = `${carData.year} ${carData.brand} ${carData.model} ${carData.version} ${carData.fuelType} - ${carData.color} ${carData.bodyType} (${carData.doors}p)`;
            elements.carImage.src = state.imageUrls[0];
            elements.photoCountLabel.innerHTML = `<img src="icons/photo-count.svg" alt="Info Icon" width="16" height="16">${state.currentImageIndex + 1} of ${carData.imageCount}`;
            elements.overview.innerHTML = `${carData.year} | ${carData.transmissionType} | ${carData.kilometres} km ${carData.fuelType} | ${carData.powerKW} kW (${carData.powerCV} CV)` || 'Descripción no disponible';
            elements.garantiaContainer.innerHTML = renderWarranty(carData.warrantyDescription, carData.standardWarranty, carData.vipWarranty);

            // Update dropdowns
            const dropdownContainer = document.getElementById('equipamiento');
            dropdownContainer.innerHTML = `
                <div class="dropdown-container">
                    <h2 class="container-title">Car Features</h2>
                    ${createDetailsDropdown('Exterior', 'exteriorContent', carData.exteriorEquipment)}
                    ${createDetailsDropdown('Interior', 'interiorContent', carData.interiorEquipment)}
                    ${createDetailsDropdown('Multimedia', 'multimediaContent', carData.multimediaFeatures)}
                    ${createDetailsDropdown('Seguridad', 'seguridadContent', carData.safetyFeatures)}
                </div>
            `;

            // Attach event listeners to dropdown titles
            document.querySelectorAll('.dropdown-title').forEach(title => {
                title.addEventListener('click', toggleEquipamientoDropdown);
            });

            // Show the first dropdown by default
            document.getElementById('exteriorContent').classList.add('show');
            document.querySelector('.dropdown-title img').src = 'icons/icon-open.svg';

            // Calculate financing details
            const vehicleDeposit = carData.price * 0.1;
            const { annualRateTIN, loanLengthMonths, commissionRate } = setLoanParameters(carData.price, carData.year, carData.kilometres);

            const result = calculateRate(
                loanLengthMonths / 12, // Convert months to years
                carData.price, // Total price
                vehicleDeposit, // Initial deposit
                annualRateTIN / 100, // Convert annual rate from percentage
                commissionRate / 100, // Convert commission rate from percentage
                0.0 // No additional fees
            );

            const precioFinacio = carData.price - vehicleDeposit;
            const formattedValues = {
                precioNuevo: formatCurrency(carData.price),
                financioDescubiento: formatCurrency(vehicleDeposit),
                precioFinacio: formatCurrency(precioFinacio),
                pmt: formatCurrency(Math.abs(result.pmt))
            };

            // Update elements with formatted values
            updateElementText(elements.pmtValue, formattedValues.pmt, 'desde ');
            updateElementText(elements.financeAmount, formattedValues.financioDescubiento, '-');
            updateElementText(elements.precioNuevo, formattedValues.precioNuevo);
            updateElementText(elements.precioFinacio, formattedValues.precioFinacio);
            updateElementText(elements.PrecioFinal, formattedValues.precioFinacio);
        }

        // Initialize checkboxes and detail divs
        initializeCheckboxes(carData.price)
        initializeDetails(carData);


    });

    function updateElementText(element, value, prefix = '') {
        if (element) {
            element.textContent = `${prefix}${value}*`;
        }
    }

    function initializeCheckboxes(price) {
        const container = document.getElementById('carFinanceOptionsContainer');

        // Create and append the first checkbox div for finance options
        const financeDiv = document.createElement('div');
        financeDiv.className = 'price-group__entry checkbox-wrapper';
        financeDiv.innerHTML = `
            <input type="checkbox" id="financeCheckbox" checked>
            <label for="financeCheckbox"></label>
            <span id="financeAmount_title" class="entry__title">Descuento por financiación</span>
            <span class="entry__amount" id="financeAmount">-${formatCurrency(price * 0.1)}*</span>
        `;
        container.appendChild(financeDiv);

        // Create and append the second checkbox div for warranty options
        const warrantyDiv = document.createElement('div');
        warrantyDiv.className = 'price-group__entry checkbox-wrapper';
        warrantyDiv.innerHTML = `
            <input type="checkbox" id="warrantyCheckbox" checked disabled>
            <label for="warrantyCheckbox"></label>
            <span id="warrantyAmount_title" class="entry__title">Garantía nacional de 12 meses</span>
            <span class="entry__amount" id="warrantyAmount">0 €</span>
        `;
        container.appendChild(warrantyDiv);

        // Create and append the third checkbox div for vehicle exchange
        const exchangeDiv = document.createElement('div');
        exchangeDiv.className = 'price-group__entry checkbox-wrapper';
        exchangeDiv.innerHTML = `
            <input type="checkbox" id="exchangeCheckbox" disabled>
            <label for="exchangeCheckbox"></label>
            <span id="exchangeAmount_title" class="entry__title">Entrega vehículo a cambio</span>
            <span class="entry__amount"><a href="/vender-mi-coche-a-cambio" rel="nofollow">Valorar mi vehículo</a></span>
        `;
        container.appendChild(exchangeDiv);

        // Create and append the fourth checkbox div for delivery options
        const deliveryDiv = document.createElement('div');
        deliveryDiv.className = 'price-group__entry checkbox-wrapper';
        deliveryDiv.innerHTML = `
            <input type="checkbox" id="deliveryCheckbox">
            <label for="deliveryCheckbox"></label>
            <span id="deliveryLabel_title" class="entry__title">Entrega a domicilio</span>
            <select id="regionDropdown" style="display: none;"></select>
            <span class="entry__amount" id="regionAmount">Activar</span>
        `;
        container.appendChild(deliveryDiv);
    }


    /**
 * Creates a detail div with icon, value, and title.
 * @param {string} containerId - The ID of the container to append the detail div.
 * @param {string} iconName - The icon name to display.
 * @param {string} value - The detail value to display.
 * @param {string} title - The detail title to display.
 * @param {string} [additionalInfo=''] - Optional additional info to display.
 * @param {string} [additionalData=''] - Optional additional data for onclick event.
 */
    function createDetailDiv(containerId, iconName, value, title, additionalInfo = '', onClickEvent = '', additionalData = '') {
        const container = document.getElementById(containerId);
        const detailDiv = document.createElement('div');
        detailDiv.className = 'more-details';

        // Serialize additionalData to a JSON string
        const serializedData = additionalData ? encodeURIComponent(JSON.stringify(additionalData)) : '';

        detailDiv.innerHTML = `
        <img src="icons/details/${iconName}.svg" alt="${title}" width="48" height="48">
        <div class="detail-text">
            <span class="detail-result">${value}</span>
            <span class="detail-title">${title}</span>
            ${additionalInfo ? `<label class="more-information" onclick="${onClickEvent}(event, '${serializedData}')">
                <img src="icons/more-information.svg" alt="More information" width="12" height="12">
                ${additionalInfo}
            </label>` : ''}
        </div>
    `;

        container.appendChild(detailDiv);
    }

    /**
     * Initializes detail and advantage sections with data.
     * @param {Object} carData - Object containing car data.
     */
    function initializeDetails(carData) {
        const details = [
            { id: 'kilometres', value: `${carData.kilometres} km`, title: 'Kilometres' },
            { id: 'horsepower', value: `${carData.powerCV} CV`, title: 'Horsepower' },
            { id: 'fuel', value: carData.fuelType, title: 'Fuel Type' },
            { id: 'transmission', value: carData.transmissionType, title: 'Transmission' },
            { id: 'gears', value: carData.gears, title: 'Nº Gears' },
            { id: 'registration', value: carData.year, title: 'Car Registered' },
            { id: 'doors', value: carData.doors, title: 'Nº doors' },
            { id: 'seats', value: carData.seats, title: 'Nº Seats' },
            { id: 'colour', value: carData.color, title: 'Colour Exterior' },
            { id: 'consumption', value: `${carData.averageConsumption} l/100`, title: 'Fuel Consumption', additionalInfo: 'See All', onClickEvent: 'showConsumptionInfo', additionalData: carData }
        ];

        // Only add emissions detail if carData.emissions is not an empty string
        if (carData.emissionLabel !== '') {
            details.push({
                id: 'emissions',
                value: `${carData.co2Emissions} g/km`,
                title: 'Emissions CO2',
                additionalInfo: 'More Information',
                onClickEvent: 'showEmissionsInfo',
                additionalData: carData
            });
        }

        details.forEach(({ id, value, title, additionalInfo, onClickEvent, additionalData }) => {
            createDetailDiv('carOverviewContainer', id, value, title, additionalInfo, onClickEvent, additionalData);
        });

        const advantages = [
            { id: 'advantages/documentation', value: 'Vehículos revisados', title: 'Revisión de 250 puntos revisados por nuestro equipo de profesionales.' },
            { id: 'advantages/mileage-guarantee', value: 'Kilometraje garantizado', title: 'Somos transparentes. Compra tu coche con certificado de kilómetros reales.' },
            { id: 'advantages/guarantee', value: 'Garantía de 12 meses', title: 'Este vehículo dispone de una garantía de 12 meses.' },
            { id: 'advantages/home-delivery', value: 'Envío a domicilio', title: 'Sin desplazamientos, te lo llevamos a casa. Antes de lo que crees, lo tendrás en tus manos.' },
            { id: 'advantages/part-exchange', value: 'Aceptamos tu coche como parte del pago', title: 'Te ofrecemos las tasaciones más competitivas del mercado.' },
            { id: 'advantages/test-drive', value: 'Pruébalo sin compromiso', title: 'Dispones de 15 días o 1.000 km para probar el vehículo. Si no te convence, cámbialo por otro.' }
        ];

        advantages.forEach(({ id, value, title }) => {
            createDetailDiv('companyAdvantagesContainer', id, value, title);
        });
    }







    function renderWarranty(description, standard, vip) {
        return `<h3>Garantía</h3><p>${description || 'Descripción no disponible'}</p><ul>
            <li>Estándar: ${standard || 'No disponible'}</li>
            <li>VIP: ${vip || 'No disponible'}</li></ul>
        `;
    }














    // Constants
    const ICON_OPEN_SRC = 'icons/icon-open.svg';
    const ICON_CLOSED_SRC = 'icons/icon-closed.svg';

    /**
     * Toggles the visibility of dropdown content and updates the icon.
     * @param {Event} event - The click event that triggered the dropdown toggle.
     */
    function toggleEquipamientoDropdown(event) {
        const targetTitle = event.target.closest('.dropdown-title');
        if (!targetTitle) return;

        const targetId = targetTitle.getAttribute('data-target');
        const targetElement = document.getElementById(targetId);
        const imgElement = targetTitle.querySelector('img');

        // Hide all dropdown contents and reset icons
        document.querySelectorAll('.equipamiento-dropdown-content').forEach(content => {
            if (content !== targetElement) content.classList.remove('show');
        });

        document.querySelectorAll('.dropdown-title img').forEach(img => {
            if (img !== imgElement) img.src = ICON_CLOSED_SRC;
        });

        // Toggle the clicked dropdown content and update icon
        const isOpen = targetElement.classList.toggle('show');
        imgElement.src = isOpen ? ICON_OPEN_SRC : ICON_CLOSED_SRC;
    }

    /**
     * Creates the HTML structure for a region dropdown.
     * @param {string} title - The title of the dropdown.
     * @param {string} targetId - The ID to associate with the dropdown content.
     * @param {Array<string>} items - The list of items to display in the dropdown.
     * @returns {string} - The HTML string for the dropdown.
     */
    function createDetailsDropdown(title, targetId, items) {
        return `
            <div class="dropdown">
                <label class="dropdown-title" data-target="${targetId}">
                    ${title}
                    <img src="${ICON_CLOSED_SRC}" alt="Dropdown Icon">
                </label>
                <div id="${targetId}" class="equipamiento-dropdown-content">
                    <ul class="custom-list">
                        ${items.map(item => `<li>${item}</li>`).join('')}
                    </ul>
                </div>
            </div>
        `;
    }

</script>