<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Used Cars Listings</title>


    <link rel="preload" href="style.css" as="style" onload="this.rel='stylesheet'">
    <link rel="preload" href="style-new.css" as="style" onload="this.rel='stylesheet'">


    <link rel="icon" href="icons/company/favicon.ico" type="image/x-icon">
    <style>
        .filter-row {
            display: flex;
            align-items: center;
            /* Vertically center the items */
            justify-content: space-between;
            /* Optional: spreads them apart to opposite sides */
        }

        .resetFilterButton {
            display: none;
            /* Hide by default */
        }

        .brand-title {
            width: 100%;
        }

        @media (max-width: 480px) {
            body {
                font-size: 15px;
            }
        }
    </style>
</head>

<body>
    <!-- Header -->
    <div id="header-contact-container"></div>
    <div id="header-container"></div>
    <div id="header-banner-container"></div>

    <div id="overlay" class="overlay"></div>
    <div id="loanPopup" class="popup-container" style="display: none;"></div>

    <!-- Filter Section -->
    <section class="bg-vl-grey">
        <div class="listings-info">
            <label id="filterLabel" class="filter-label">
                <div class="filter-row">
                    <span id="filterLabelText" class="filter-text">All filters</span>
                    <span class="resetFilterButton">
                        <img src="icons/ui/navigation/close-circle.svg" alt="Close" width="40" height="40">
                    </span>
                </div>

                <img src="icons/ui/actions/filter.svg" alt="Filter Icon" class="filter-icon">
            </label>
            <div id="filterPopup" class="popup-container" style="display: none;">
                <button class="resetFilterButton">Reset Filters</button>
                <div class="popup-title">
                    <div class="filter-text">All filters</div>

                    <button id="closeFilterPopup" class="close-button">
                        <img src="icons/ui/navigation/close.svg" alt="Close" width="20" height="20">
                    </button>
                </div>
                <div id="brand" class="filter-options-container"></div>
            </div>
        </div>
    </section>


    <!-- Car Listings Section -->
    <section class="car-listings" id="carListings"></section>



    <div id="footer-container"></div>

    <!-- Scripts -->
    <script type="module" defer>
        import { loadHeaderAndFooter } from './js/pageSetup.js';
        import { getAllCarData } from './js/carDataFetcher.js';
        import { renderCarListings, setFilteredCars } from './js/listingsManager.js';

        let carsData = [];

        document.addEventListener('DOMContentLoaded', async () => {
            try {
                await loadHeaderAndFooter(); // Load header and footer asynchronously

                // Fetch car data and initialize filteredCars with the fetched data
                carsData = await getAllCarData(true);
                setFilteredCars(carsData); // Use the setter function to set filteredCars

                // Call renderCarListings and pass carsData
                renderCarListings(true, carsData); // Pass carsData
            } catch (error) {
                console.error('Error initializing the page:', error);
            }
        });
    </script>
</body>

</html>